openapi: 3.1.0
info:
  title: DVI Bridge API
  version: 1.0.0

servers:
  - url: https://web-production-1cf0d.up.railway.app

paths:

  /dvi/start:
    post:
      summary: Start an inspection
      operationId: startInspection
      description: Start the DVI inspection workflow.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
      responses:
        "200":
          description: Inspection started.

  /dvi/get_rowid:
    get:
      summary: Get ROWriter RowID
      operationId: getRowId
      description: Returns the RowID needed for ISO or PMA uploads.
      parameters:
        - in: query
          name: ro_number
          required: true
          schema:
            type: string
      responses:
        "200":
          description: RowID result.

  /dvi/iso_inspection:
    post:
      summary: Submit ISO inspection results
      operationId: submitIsoInspection
      description: Sends the full ISO inspection payload to ROWriter.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          description: ISO inspection submitted.

  /dvi/upload_image:
    post:
      summary: Upload image to an inspection item
      operationId: uploadInspectionImage
      description: Uploads an image to a checklist item in ISO/PMA.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
                labor_id:
                  type: string
                item_id:
                  type: string
                images:
                  type: array
                  items:
                    type: object
                    properties:
                      file_url:
                        type: string
                      file_name:
                        type: string
      responses:
        "200":
          description: Upload successful.

  /dvi/iso_complete:
    post:
      summary: Complete ISO inspection
      operationId: completeIsoInspection
      description: Marks the ISO inspection as completed in ROWriter.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
      responses:
        "200":
          description: ISO inspection completed.

  /dvi/pma_complete:
    post:
      summary: Complete PMA inspection
      operationId: completePmaInspection
      description: Marks the PMA inspection as completed in ROWriter.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
      responses:
        "200":
          description: PMA inspection completed.

  /dvi/qc_complete:
    post:
      summary: Complete QC inspection
      operationId: completeQcInspection
      description: Marks the QC inspection as completed in ROWriter.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
      responses:
        "200":
          description: QC inspection completed.
