openapi: 3.1.0
info:
  title: DVI Bridge API
  version: 1.0.0
  description: API for ISO, PMA, QC inspections and media uploads to ROWriter.

servers:
  - url: https://web-production-1cf0d.up.railway.app

paths:

  /dvi/start:
    post:
      summary: Start a DVI inspection
      operationId: startInspection
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
              required:
                - ro_number
      responses:
        "200":
          description: Inspection started

  /dvi/get_rowid:
    get:
      summary: Get the ROWriter RowID
      operationId: getRowId
      parameters:
        - in: query
          name: ro_number
          required: true
          schema:
            type: string
      responses:
        "200":
          description: RowID result

  /dvi/iso_inspection:
    post:
      summary: Submit ISO inspection payload
      operationId: submitIsoInspection
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
              required:
                - ro_number
              additionalProperties: true
      responses:
        "200":
          description: ISO inspection submitted

  /dvi/upload_image:
    post:
      summary: Upload image to an inspection item
      operationId: uploadInspectionImage
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
                labor_id:
                  type: string
                item_id:
                  type: string
                images:
                  type: array
                  items:
                    type: object
                    properties:
                      file_url:
                        type: string
                      file_name:
                        type: string
              required:
                - ro_number
                - labor_id
                - item_id
                - images
      responses:
        "200":
          description: Image uploaded successfully

  /dvi/iso_complete:
    post:
      summary: Complete ISO inspection
      operationId: completeIsoInspection
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
              required:
                - ro_number
      responses:
        "200":
          description: ISO inspection completed

  /dvi/pma_complete:
    post:
      summary: Complete PMA inspection
      operationId: completePmaInspection
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
              required:
                - ro_number
      responses:
        "200":
          description: PMA inspection completed

  /dvi/qc_complete:
    post:
      summary: Complete QC inspection
      operationId: completeQcInspection
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ro_number:
                  type: string
              required:
                - ro_number
      responses:
        "200":
          description: QC inspection completed
